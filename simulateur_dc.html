<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Simulateur D√©c√®s ‚Äî Corrig√© (R√©gime g√©n√©ral 2025) v1.2</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
<style>
  :root{ --bg:#0e1117; --panel:#141a24; --ink:#e8eef6; --muted:#9bb1c9; --grid:#253347; --acc:#6ae3ff; --ok:#80f2a1; --warn:#ffd166; --bad:#ff7b7b; }
  *{box-sizing:border-box}
  html,body{background:var(--bg);color:var(--ink);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;margin:0}
  .wrap{max-width:1100px;margin:0 auto;padding:16px}
  h1{font-size:20px;margin:0 0 6px}
  h2{font-size:16px;margin:12px 0 8px;color:var(--acc)}
  .hint{color:var(--muted);font-size:13px}
  .grid{display:grid;gap:10px}
  .cols{grid-template-columns:repeat(12,minmax(0,1fr))}
  .col-4{grid-column:span 4}.col-8{grid-column:span 8}.col-12{grid-column:span 12}
  @media (max-width:960px){.col-4,.col-8{grid-column:span 12}}
  .card{background:var(--panel);border:1px solid #1f2939;border-radius:12px;padding:12px}
  label{display:block;font-size:12px;color:#cfe1f7;margin:4px 0}
  input,select{width:100%;background:#0b1018;color:var(--ink);border:1px solid #243149;border-radius:9px;padding:9px 10px;font-size:14px}
  input[type="checkbox"]{width:auto;transform:translateY(2px)}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px}
  .btn{background:#182234;border:1px solid #27344b;border-radius:10px;color:#e7f1ff;font-weight:600;padding:8px 10px;cursor:pointer}
  .btn:active{transform:translateY(1px)}
  .btn.ghost{background:#0f1625}
  .toolbar{display:flex;gap:8px;flex-wrap:wrap}
  .chip{display:inline-flex;align-items:center;gap:6px;background:#101623;border:1px solid #243149;color:#cfe1f7;border-radius:999px;padding:5px 9px;font-size:12px;cursor:pointer}
  .kpis{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:8px;margin-top:8px}
  .kpi{background:#0d1421;border:1px solid #27344b;border-radius:12px;padding:10px}
  .kpi h3{margin:0;font-size:12px;color:#b9c9de}
  .kpi .v{margin-top:6px;font-size:20px;font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:right;}
  .pill{display:inline-flex;gap:6px;align-items:center;border-radius:999px;padding:3px 8px;border:1px solid #2a3951;font-size:12px}
  .pill.ok{background:#0f2116;color:#9bffb1;border-color:#234f34}
  .pill.ko{background:#231014;color:#ff9a9a;border-color:#5a2323}
  .pill.warn{background:#241f0e;color:#ffd166;border-color:#5a5423}
  .toggle{display:flex;align-items:center;gap:8px}
  .section-title{display:flex;align-items:center;justify-content:space-between;gap:8px}
  .details{display:none}
  .details.open{display:block}
  canvas{width:100%!important;height:440px!important;background:#0b0f18;border:1px solid #1c273a;border-radius:12px}
  table{width:100%;border-collapse:separate;border-spacing:0;margin-top:8px}
  th,td{padding:9px;border-bottom:1px solid #24324a;text-align:right;font-variant-numeric:tabular-nums}
  th{position:sticky;top:0;background:var(--panel);text-align:right;color:#b4c3d9}
  td:first-child,th:first-child{text-align:left}
  .muted{color:var(--muted)}
  .mono{font-family:ui-monospace,Menlo,Consolas,monospace}
  .banner{border:1px solid #5a2323;background:#231014;color:#ff9a9a;padding:8px;border-radius:8px;margin:8px 0;display:none}
  .banner.show{display:block}
  .recap{background:#111a28;border:1px solid rgba(255,255,255,0.06);border-radius:14px;padding:14px 16px;margin-top:8px}
  .recap h3{margin:0 0 8px 0;color:#d6e4f5;font-weight:600;font-size:16px}
  .recap .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:8px;margin-top:6px}
  .recap .item{background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.06);border-radius:12px;padding:10px 12px;display:flex;justify-content:space-between;align-items:center}
  .recap .item b{color:#a9c3e6}
  .recap .item .val{font-variant-numeric:tabular-nums;letter-spacing:.3px}
  .recap .hint{font-size:12px;opacity:.7;margin-top:6px}
</style>
</head>
<body>
<div class="wrap">
  <div class="section-title">
    <h1>Simulateur de pouvoir d‚Äôachat apr√®s d√©c√®s ‚Äî <span class="hint">R√©gime g√©n√©ral (2025)</span></h1>
    <div class="toolbar">
      <button id="btnSave" class="btn">üíæ Sauver</button>
      <button id="btnReset" class="btn ghost">‚ôªÔ∏è R√©init</button>
      <button id="btnCSV" class="btn">‚¨áÔ∏è Export CSV</button>
    </div>
  </div>
  <div class="toolbar" style="margin-top:6px">
    <button id="btnMode" class="btn">üóì Mode: Ann√©e</button>
    <label class="toggle"><input id="toggleStacked" type="checkbox" checked/> Barres empil√©es</label>
    <button id="btnPNG" class="btn">üñº Export PNG</button>
  </div>
  <div id="banner" class="banner">Tous les montants semblent √† 0. V√©rifiez les champs.</div>
  <div id="ageBadge" class="hint" style="margin:6px 0"></div>

  <div class="card" style="margin-top:8px">
    <div class="section-title"><h2>Exemples rapides</h2><span class="hint">Charge 1 clic pour tester.</span></div>
    <div class="toolbar">
      <span class="chip" data-scenario="T1">T1 Mari√© + 2 enfants</span>
      <span class="chip" data-scenario="T2">T2 Pacs√© (pas de veuvage/r√©version)</span>
      <span class="chip" data-scenario="T5">T5 Contrat 60 000‚Ç¨ sur 5 ans</span>
    </div>
  </div>

  <div class="grid cols" style="margin-top:8px">
    <div class="card col-4">
      <h2>1) Situation</h2>
      <div class="row"><div><label>Statut familial</label><select id="statut"><option value="marie">Mari√©</option><option value="pacse">Pacs√©</option><option value="concubin">Concubin</option><option value="celibataire">C√©libataire</option></select></div><div><label>Parent d√©c√©d√©</label><select id="parentDecede"><option value="A">Parent A (assur√©)</option><option value="B">Parent B (conjoint)</option></select></div></div>
      <div class="row"><div><label>Pr√©nom A (assur√©)</label><input id="prenomA" placeholder="Ex: Alice"/></div><div><label>Pr√©nom B (conjoint)</label><input id="prenomB" placeholder="Ex: Beno√Æt"/></div></div>
      <div class="row"><div><label>Revenu mensuel A (‚Ç¨)</label><input id="revenuA" inputmode="decimal" placeholder="ex: 3000"/></div><div><label>Revenu mensuel B (‚Ç¨)</label><input id="revenuB" inputmode="decimal" placeholder="ex: 2500"/></div></div>
      <div class="row"><div><label>√Çge du survivant (ans)</label><input id="ageSurvivant" inputmode="numeric" placeholder="ex: 40"/></div><div><label>Charges mensuelles (‚Ç¨)</label><input id="chargesAnnuelles" inputmode="decimal" placeholder="ex: 2000"/></div></div>
      <div class="row"><div><label>Retraite base d√©funt (‚Ç¨/mois)</label><input id="retBaseDefunt" inputmode="decimal" placeholder="ex: 900"/></div><div class="toggle"><label><input type="checkbox" id="useMinReversion"/> Forcer minimum l√©gal</label></div></div>
      <div class="row"><div class="toggle"><label><input type="checkbox" id="parentIsole"/> Parent isol√© / vit seul</label></div><div class="toggle"><label><input type="checkbox" id="newUnion"/> Nouvelle union</label></div></div>
      <div class="row"><div><label>Horizon (ann√©es)</label><input id="horizon" inputmode="numeric" value="25"/></div><div><label>√Çge du d√©funt (ans)</label><input id="ageDefunt" inputmode="numeric" placeholder="ex: 42"/></div></div>
      <div id="eligMsgs" style="margin-top:6px"></div>
    </div>
    <div class="card col-4">
      <h2>2) Enfants</h2>
      <label>Ajouter un enfant (√¢ge au d√©c√®s)</label>
      <div style="display:flex;gap:8px"><input id="ageEnfantAdd" inputmode="numeric" placeholder="ex: 6"/><button id="btnAddEnfant" class="btn">+ Ajouter</button></div>
      <div id="enfantsList" class="hint" style="margin-top:6px">Aucun enfant.</div>
      <h2 style="margin-top:12px">Rappels d‚Äô√©ligibilit√©</h2>
      <ul class="hint"><li><b>Allocation veuvage</b> : mari√©(e), &lt;55 ans, sans nouvelle union, sous plafond.</li><li><b>R√©version</b> : mari√©(e), d√®s 55 ans, sous plafonds.</li><li><b>ASF</b> : parent isol√© (cesse en cas de nouvelle union).</li></ul>
    </div>
    <div class="card col-4">
      <h2>3) Contrat & CPAM</h2>
      <div class="row"><div><label>Capital priv√© (‚Ç¨)</label><input id="capPrive" inputmode="decimal" placeholder="ex: 60 000"/></div><div><label>Dur√©e lissage (ans)</label><input id="dureePrive" inputmode="numeric" placeholder="ex: 5"/></div></div>
      <div class="row"><div><label>Capital d√©c√®s CPAM (‚Ç¨)</label><input id="capCPAM" inputmode="decimal" /></div><div class="toggle" style="align-items:end"><label><input type="checkbox" id="lisserCPAM"/> Lisser sur 12 mois</label></div></div>
      <div id="recap3" class="recap"><h3>Besoin de capital d√©c√®s</h3><div id="recapText" class="hint"></div><div class="grid"><div class="item"><b>Capital √† pr√©voir (5 ans)</b><span id="need5" class="val">‚Äî</span></div><div class="item"><b>Capital √† pr√©voir (10 ans)</b><span id="need10" class="val">‚Äî</span></div></div><div class="hint">Couvre le d√©ficit mensuel (revenus vs charges), sans rendement.</div></div>
    </div>
  </div>
  <div class="card col-12" style="margin-top:10px">
    <div class="section-title"><h2>Revenus vs Charges</h2><label class="toggle"><input type="checkbox" id="toggleEvents" checked/> Afficher les √©v√©nements</label></div>
    <canvas id="chart"></canvas>
  </div>
</div>

<script>
const nf2=new Intl.NumberFormat('fr-FR',{style:'currency',currency:'EUR',maximumFractionDigits:2});
const $=id=>document.getElementById(id);
function parseEuro(v){ if(v===null||v===undefined) return 0; if(typeof v==='number'&&Number.isFinite(v)) return v; let s=(''+v).trim(); if(s==='')return 0; s=s.replace(/[‚Ç¨$¬£‚Ç§]/g,'').replace(/\s/g,'').replace(/,/g,'.'); const x=parseFloat(s); return Number.isFinite(x)?x:0; }
let enfants=[];
let chartInstance;
const I={statut:$('statut'),parentDecede:$('parentDecede'),revenuA:$('revenuA'),revenuB:$('revenuB'),ageSurvivant:$('ageSurvivant'),chargesAnnuelles:$('chargesAnnuelles'),retBaseDefunt:$('retBaseDefunt'),useMinReversion:$('useMinReversion'),parentIsole:$('parentIsole'),newUnion:$('newUnion'),horizon:$('horizon'),ageEnfantAdd:$('ageEnfantAdd'),btnAddEnfant:$('btnAddEnfant'),enfantsList:$('enfantsList'),capPrive:$('capPrive'),dureePrive:$('dureePrive'),capCPAM:$('capCPAM'),lisserCPAM:$('lisserCPAM'),eligMsgs:$('eligMsgs'),chart:$('chart'),btnSave:$('btnSave'),btnReset:$('btnReset'),btnCSV:$('btnCSV'),banner:$('banner'),prenomA:$('prenomA'),prenomB:$('prenomB'),ageDefunt:$('ageDefunt'),btnMode:$('btnMode'),toggleStacked:$('toggleStacked'),btnPNG:$('btnPNG'),recapText:$('recapText'),need5:$('need5'),need10:$('need10')};
// Config (hardcoded for simplicity, could be moved to inputs in a full version)
const CFG = { veuvage_m: 713.17, veuvage_plaf_m: 891.46, rev_min_m: 331.94, rev_plaf_solo_a: 24710.40, rev_plaf_couple_a: 39536.64, rev_apply_plaf: true, asf_m: 199.19, asf_age: 20, cpam_def: 3977 };
function setDefaults(){ I.statut.value='marie'; I.parentDecede.value='A'; I.revenuA.value=3000; I.revenuB.value=2500; I.ageSurvivant.value='40'; I.chargesAnnuelles.value=2000; I.retBaseDefunt.value=900; I.useMinReversion.checked=true; I.parentIsole.checked=true; I.newUnion.checked=false; I.horizon.value='25'; I.capPrive.value=60000; I.dureePrive.value=5; I.capCPAM.value=CFG.cpam_def; I.lisserCPAM.checked=false; enfants=[6,3]; renderEnfants(); }
function renderEnfants(){ I.enfantsList.innerHTML = enfants.length ? enfants.map((a,i)=>`<span class="chip">#${i+1} ‚Äî ${a} ans <button data-del="${i}" style="padding:1px 5px;font-size:10px;border-radius:50%">x</button></span>`).join(' ') : '<span class="hint">Aucun enfant.</span>'; }
function calcVeuvage(ctx){ const {statut,newUnion,ageSurvivantM,revenusSurvivantMensuel}=ctx; if(statut!=='marie') return {per:0,dur:0,ok:false,reason:'Non mari√©'}; if(newUnion) return {per:0,dur:0,ok:false,reason:'Nouvelle union'}; if(ageSurvivantM>=55*12) return {per:0,dur:0,ok:false,reason:'√Çge ‚â•55'}; if(revenusSurvivantMensuel>CFG.veuvage_plaf_m) return {per:0,dur:0,ok:false,reason:'Plafond d√©pass√©'}; let dur=24; if(ageSurvivantM>=50*12 && ageSurvivantM<55*12){ dur=Math.max(dur,Math.round(55*12-ageSurvivantM)); } return {per:CFG.veuvage_m,dur,ok:true,reason:'OK'}; }
function calcReversion(ctx){ const {statut,ageSurvivantM,revenusSurvivantAnnuel,retBaseDefunt,useMinReversion,parentIsole,newUnion}=ctx; if(statut!=='marie') return {ok:false,startM:null,per:0,info:'Non mari√©'}; const startM=Math.max(0,Math.round(55*12-ageSurvivantM)); let base=useMinReversion?CFG.rev_min_m:Math.max(CFG.rev_min_m,0.54*(retBaseDefunt||0)); if(CFG.rev_apply_plaf){ const isSolo=(!newUnion)&&(!!parentIsole); const plafondA=isSolo?CFG.rev_plaf_solo_a:CFG.rev_plaf_couple_a; const maxRevAn=Math.max(0,plafondA-revenusSurvivantAnnuel); base=Math.max(0,Math.min(base,maxRevAn/12)); } return {ok:true,startM,per:base,info:'Sous r√©serve ressources'}; }
function calcASF(ctx,m){ if(!ctx.parentIsole||ctx.newUnion) return 0; const lim=CFG.asf_age*12; let n=0; for(const ageY of ctx.enfantsAges){ const ageM=Math.round(ageY*12)+m; if(ageM<lim) n++; } return CFG.asf_m*n; }
function rentePedago(capital,dureeY){ const cap=parseEuro(capital), d=parseFloat(dureeY||0); if(cap<=0||d<=0) return 0; return cap/(12*d); }
function getState(){ const statut=I.statut.value,parentDecede=I.parentDecede.value; const revA=parseEuro(I.revenuA.value)*12,revB=parseEuro(I.revenuB.value)*12; const chargesAn=parseEuro(I.chargesAnnuelles.value)*12; const ageS=parseFloat(I.ageSurvivant.value||0); const retBase=parseEuro(I.retBaseDefunt.value),useMin=I.useMinReversion.checked; const parentIsole=I.parentIsole.checked,newUnion=I.newUnion.checked; const horizonY=parseFloat(I.horizon.value||0); const capPrive=parseEuro(I.capPrive.value),dureePrive=parseFloat(I.dureePrive.value||0); const capCPAM=parseEuro(I.capCPAM.value),lisserCPAM=I.lisserCPAM.checked; const revSurvAn=(parentDecede==='A'?revB:revA); const ctx={ statut,parentDecede,parentIsole,newUnion, ageSurvivantM:ageS*12, revenusSurvivantMensuel:revSurvAn/12, revenusSurvivantAnnuel:revSurvAn, retBaseDefunt:retBase,useMinReversion:useMin, enfantsAges:[...enfants] }; return {ctx,revA,revB,chargesAn,capPrive,dureePrive,capCPAM,lisserCPAM,horizonY}; }
function simulate(){
    const S=getState(); I.banner.classList.toggle('show', (!S.revA && !S.revB && !S.chargesAn));
    const months=Math.round(S.horizonY*12), chargesM=S.chargesAn/12;
    const veuv=calcVeuvage(S.ctx), rev=calcReversion(S.ctx);
    const rentePrive=rentePedago(S.capPrive,S.dureePrive), finPrivM=rentePrive>0?Math.round(S.dureePrive*12):null;
    const cpamLisseM=S.lisserCPAM?(S.capCPAM/12):0, finCPAMM=S.lisserCPAM?12:null;
    const revSurvM=S.ctx.revenusSurvivantAnnuel/12;
    const arrRevSans=new Array(months).fill(0), arrRevAvec=new Array(months).fill(0);
    const comp={rev:[],veuv:[],asf:[],contrat:[],cpam:[], salary:[]};
    for(let m=0;m<months;m++){ const v=(veuv.ok&&m<veuv.dur)?veuv.per:0; const r=(rev.ok&&m>=rev.startM)?rev.per:0; const a=calcASF(S.ctx,m); const totalSans=revSurvM+v+r+a; const contratM=(m<(finPrivM||0))?rentePrive:0; const cpamM=(m<12&&S.lisserCPAM)?cpamLisseM:0; arrRevSans[m]=totalSans; arrRevAvec[m]=totalSans+contratM+cpamM; comp.rev[m]=r; comp.veuv[m]=v; comp.asf[m]=a; comp.contrat[m]=contratM; comp.cpam[m]=cpamM; comp.salary[m]=revSurvM; }
    const years=Math.ceil(months/12);
    const avgY=(arr,y)=>{const s=y*12,e=Math.min(months,(y+1)*12);const sub=arr.slice(s,e);return sub.length?sub.reduce((a,b)=>a+b,0)/sub.length:0;};
    const labels=[...Array(years)].map((_,i)=>`A${i+1}`);
    const sumDef = (N)=>{ let s=0; for(let i=0;i<N;i++){ const def = (chargesM - (arrRevAvec[i]||0)); if(def>0) s+=def; } return s; };
    let need5 = Math.max(0, sumDef(60)), need10 = Math.max(0, sumDef(120));
    const adjust = S.lisserCPAM ? 0 : S.capCPAM;
    I.need5.textContent = nf2.format(Math.max(0, need5 - adjust)); I.need10.textContent = nf2.format(Math.max(0, need10 - adjust));
    drawChart({labels, comp, chargesM});
}
function drawChart({labels,comp,chargesM}){
    if(chartInstance) chartInstance.destroy();
    const ctx = I.chart.getContext('2d');
    const Y=labels.length;
    const agg=(arr)=>{ const out=[]; for(let y=0;y<Y;y++){ const s=y*12,e=s+12; const sub=arr.slice(s,e); out.push(sub.length? sub.reduce((a,b)=>a+b,0)/sub.length : 0);} return out; };
    const compY={ salary:agg(comp.salary), veuv:agg(comp.veuv), rev:agg(comp.rev), asf:agg(comp.asf), cpam:agg(comp.cpam), contrat:agg(comp.contrat) };
    const totals = labels.map((_,i)=> (compY.salary[i]||0)+(compY.veuv[i]||0)+(compY.rev[i]||0)+(compY.asf[i]||0)+(compY.cpam[i]||0)+(compY.contrat[i]||0));
    const seriesMax = Math.max(0, ...totals);
    const yMax = Math.max(500, Math.ceil((Math.max(seriesMax, chargesM)*1.20)/100)*100);
    chartInstance = new Chart(ctx, {
        type:'bar',
        data:{ labels, datasets:[
            {label:'Salaire survivant', data:compY.salary, backgroundColor:'var(--acc)'},
            {label:'Veuvage', data:compY.veuv, backgroundColor:'var(--ok)'},
            {label:'R√©version', data:compY.rev, backgroundColor:'var(--warn)'},
            {label:'ASF', data:compY.asf, backgroundColor:'#a855f7'},
            {label:'CPAM (liss√©)', data:compY.cpam, backgroundColor:'#64748b'},
            {label:'Contrat (liss√©)', data:compY.contrat, backgroundColor:'var(--bad)'},
            {label:`Charges (${nf2.format(chargesM)})`, data:new Array(labels.length).fill(chargesM), type:'line', borderColor:'var(--muted)', tension:0, pointRadius:0, borderDash:[5,5]}
        ]},
        options:{ responsive:true, maintainAspectRatio:false, scales:{ x:{stacked:true, ticks:{color:'var(--muted)'}, grid:{color:'var(--grid)'}}, y:{stacked:true, min:0, max:yMax, ticks:{color:'var(--muted)', callback:v=>nf2.format(v)}, grid:{color:'var(--grid)'}} }, plugins:{ legend:{ labels:{color:'var(--ink)'} } } }
    });
}
function saveState(){ const s={statut:I.statut.value,parentDecede:I.parentDecede.value,revenuA:I.revenuA.value,revenuB:I.revenuB.value,ageSurvivant:I.ageSurvivant.value,chargesAnnuelles:I.chargesAnnuelles.value,retBaseDefunt:I.retBaseDefunt.value,useMinReversion:I.useMinReversion.checked,parentIsole:I.parentIsole.checked,newUnion:I.newUnion.checked,horizon:I.horizon.value,capPrive:I.capPrive.value,dureePrive:I.dureePrive.value,capCPAM:I.capCPAM.value,lisserCPAM:I.lisserCPAM.checked,enfants:enfants, prenomA:I.prenomA.value, prenomB:I.prenomB.value, ageDefunt: I.ageDefunt.value }; localStorage.setItem('simu_deces_v1_1',JSON.stringify(s)); }
function loadState(){ const raw=localStorage.getItem('simu_deces_v1_1'); if(!raw) return false; try{ const s=JSON.parse(raw); Object.keys(s).forEach(k=>{ if(I[k]){ if(typeof s[k]==='boolean') I[k].checked=s[k]; else I[k].value=s[k]; }}); enfants=Array.isArray(s.enfants)?s.enfants:[]; renderEnfants(); return true; }catch(e){ return false; } }
I.btnAddEnfant.onclick=()=>{ const age=parseFloat(I.ageEnfantAdd.value||''); if(!isFinite(age)||age<0||age>25){alert('√Çge invalide.');return;} enfants.push(age); I.ageEnfantAdd.value=''; renderEnfants(); saveState(); simulate(); };
I.enfantsList.addEventListener('click', e=>{ if(e.target.dataset.del){ enfants.splice(parseInt(e.target.dataset.del),1); renderEnfants(); saveState(); simulate(); }});
Object.keys(I).forEach(id=>{ if(I[id] && id!=='btnAddEnfant' && id!=='enfantsList' && !id.startsWith('btn')) I[id].addEventListener('input',()=>{saveState(); simulate();}); });
I.btnSave.onclick=()=>{saveState(); alert('Sauvegard√©.');};
I.btnReset.onclick=()=>{ if(confirm('R√©initialiser ?')){ enfants=[]; setDefaults(); localStorage.removeItem('simu_deces_v1_1'); saveState(); simulate(); }};
document.querySelectorAll('[data-scenario]').forEach(x=>{ x.onclick=()=>{ const k=x.getAttribute('data-scenario'); setDefaults(); if(k==='T1'){ I.statut.value='marie'; I.revenuA.value=3000; I.revenuB.value=2500; I.ageSurvivant.value=40; I.chargesAnnuelles.value=2000; I.parentIsole.checked=true; enfants=[6,3]; } if(k==='T2'){ I.statut.value='pacse'; I.revenuA.value=2800; I.revenuB.value=2200; I.ageSurvivant.value=38; I.chargesAnnuelles.value=1800; I.parentIsole.checked=true; enfants=[7]; } if(k==='T5'){ I.capPrive.value=60000; I.dureePrive.value=5; } renderEnfants(); saveState(); simulate(); }; });
(function init(){ if(!loadState()){setDefaults();} updateParentOptions(); simulate(); })();
</script>
</body>
</html>
